#!/bin/sh

# ユーティリティ タイトル表示
title() {
    echo "-----> $*"
}

# ユーティリティ サブタイトル表示
subtitle() {
    echo "       $*"
}

ls -la

#ls -R | grep ":$" | sed -e 's/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'

#ls -la ./step/

title "initlialize"
BUILD_DIR=$1 # /tmp/build_#HASH#
INSTALL_DIR=$HOME/.vendor
mkdir -p $INSTALL_DIR
CACHE_DIR=$2 #/app/tmp/cache

BIN_DIR=$(cd $(dirname $0); pwd) # absolute path

title "build step by step"

# mecab buildpack
. BIN_DIR/steps/compile-mecab BUILD_DIR INSTALL_DIR CACHE_DIR

# ビルド結果の保存
(cd $HOME && tar cf - .vendor) | (cd $BUILD_DIR && tar xf -)

subtitle "+focus buildpack finished"