#!/usr/bin/env bash

# Syntax sugar
poppler_indent () {
    echo "              [poppler] $*"
}

# Initialize
poppler_indent "initlialize"
BUILD_DIR=$1
LIB_DIR=$2     # $BIN_DIR/lib
INSTALL_DIR=$3 # /app/.vendor
# INSTALL_DIR=$BUILD_DIR/vendor/poppler
CACHE_DIR=$4   # /app/tmp/cache
PROFILE_DIR=$5 # $BUILD_DIR/.profile.d
POPPLER_DIR=${HOME}/vendor/poppler

poppler_indent "build popper"
#tar -Jxf $LIB_DIR/poppler-0.67.0.tar.xz -C $INSTALL_DIR
tar -zxf $LIB_DIR/poppler-0.37.0.tar.gz -C $INSTALL_DIR/poppler-0.37.0/

poppler_indent "Complete!"

poppler_indent "set env path"
echo 'export PATH="$PATH:/app/.vendor/poppler-0.37.0/bin"' > $PROFILE_DIR/poppler.sh
echo 'export LD_LIBRARY_PATH="$LD_LIBRARY_PATH:/app/.vendor/poppler-0.67.0/lib"' >> $PROFILE_DIR/poppler.sh
